{"ast":null,"code":"var _jsxFileName = \"C:\\\\Project_js\\\\THweb\\\\University4\\\\BaiTapCuoiKi\\\\Frontend\\\\src\\\\components\\\\application\\\\ApplicationForm.tsx\",\n  _s = $RefreshSig$();\n// src/components/application/ApplicationForm.tsx\n// chuyển hướng đi lên xuốngxuống\nimport React, { useState, useEffect } from \"react\";\nimport CombinedForm from \"./CombinedForm\";\nimport Step4_UploadDocuments from \"../../pages/Step4_UploadDocuments\";\nimport Step5_ReviewAndSubmit from \"../../pages/Step5_ReviewAndSubmit\";\nimport \"../../styles.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ApplicationForm = ({\n  setPage,\n  currentUser,\n  setFormData,\n  nextStep\n}) => {\n  _s();\n  const [step, setStep] = useState(1);\n  const [formDataState, setFormDataState] = useState({\n    school: \"\",\n    major: \"\",\n    examCombination: \"\",\n    personalInfo: {\n      name: currentUser || \"\",\n      dateOfBirth: \"\",\n      address: \"\",\n      phone: \"\",\n      cccd: \"\",\n      ethnicity: \"\",\n      gender: \"\"\n    },\n    scores: {},\n    transcriptScores: {\n      semester1Grade12: {\n        math: \"\",\n        literature: \"\",\n        english: \"\",\n        physics: \"\",\n        chemistry: \"\",\n        biology: \"\"\n      },\n      semester2Grade12: {\n        math: \"\",\n        literature: \"\",\n        english: \"\",\n        physics: \"\",\n        chemistry: \"\",\n        biology: \"\"\n      },\n      semester1Grade11: {\n        math: \"\",\n        literature: \"\",\n        english: \"\",\n        physics: \"\",\n        chemistry: \"\",\n        biology: \"\"\n      },\n      semester2Grade11: {\n        math: \"\",\n        literature: \"\",\n        english: \"\",\n        physics: \"\",\n        chemistry: \"\",\n        biology: \"\"\n      }\n    },\n    priorityCategories: [],\n    documents: [],\n    documents2: [],\n    documents3: [],\n    status: \"Chờ duyệt\",\n    submissionDate: new Date().toLocaleDateString()\n  });\n\n  // Update parent's formData whenever local state changes\n  useEffect(() => {\n    console.log(\"Updating parent formData:\", formDataState);\n    setFormData(formDataState);\n  }, [formDataState, setFormData]);\n\n  // Update local state when currentUser changes\n  useEffect(() => {\n    if (currentUser) {\n      setFormDataState(prev => ({\n        ...prev,\n        personalInfo: {\n          ...prev.personalInfo,\n          name: currentUser\n        }\n      }));\n    }\n  }, [currentUser]);\n  const prevStep = () => setStep(step - 1);\n  const handleFormSubmit = async () => {\n    try {\n      console.log(\"Starting form submission with data:\", formDataState);\n\n      // Validate required fields\n      if (!formDataState.school || !formDataState.major || !formDataState.examCombination) {\n        console.error(\"Missing required fields:\", {\n          school: formDataState.school,\n          major: formDataState.major,\n          examCombination: formDataState.examCombination\n        });\n        return {\n          status: \"error\"\n        };\n      }\n\n      // Validate user\n      if (!currentUser) {\n        console.error(\"No current user found\");\n        return {\n          status: \"error\"\n        };\n      }\n\n      // Create updated form data\n      const updatedFormData = {\n        ...formDataState,\n        status: \"Chờ duyệt\",\n        submissionDate: new Date().toLocaleDateString(),\n        personalInfo: {\n          ...formDataState.personalInfo,\n          name: currentUser\n        }\n      };\n      console.log(\"Prepared form data for submission:\", updatedFormData);\n\n      // Update both local and parent state\n      setFormDataState(updatedFormData);\n      setFormData(updatedFormData);\n\n      // Call nextStep to trigger the parent's submission logic\n      nextStep();\n      console.log(\"Form submitted successfully\");\n      return {\n        status: \"success\"\n      };\n    } catch (error) {\n      console.error(\"Error in form submission:\", error);\n      return {\n        status: \"error\"\n      };\n    }\n  };\n  const renderStep = () => {\n    switch (step) {\n      case 1:\n        return /*#__PURE__*/_jsxDEV(CombinedForm, {\n          setFormData: setFormDataState,\n          nextStep: () => setStep(step + 1),\n          setPage: setPage,\n          currentUser: currentUser\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this);\n      case 2:\n        return /*#__PURE__*/_jsxDEV(Step4_UploadDocuments, {\n          formData: formDataState,\n          setFormData: setFormDataState,\n          nextStep: () => setStep(step + 1),\n          prevStep: prevStep,\n          setPage: setPage,\n          currentUser: currentUser\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 11\n        }, this);\n      case 3:\n        return /*#__PURE__*/_jsxDEV(Step5_ReviewAndSubmit, {\n          formData: formDataState,\n          prevStep: prevStep,\n          submitForm: handleFormSubmit,\n          setPage: setPage,\n          currentUser: currentUser,\n          setApplicationData: setFormData\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }, this);\n      default:\n        return null;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"application-form\",\n    children: renderStep()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 191,\n    columnNumber: 10\n  }, this);\n};\n_s(ApplicationForm, \"dLouM2tWu3YEvjYpk7uolFgIayQ=\");\n_c = ApplicationForm;\nexport default ApplicationForm;\nvar _c;\n$RefreshReg$(_c, \"ApplicationForm\");","map":{"version":3,"names":["React","useState","useEffect","CombinedForm","Step4_UploadDocuments","Step5_ReviewAndSubmit","jsxDEV","_jsxDEV","ApplicationForm","setPage","currentUser","setFormData","nextStep","_s","step","setStep","formDataState","setFormDataState","school","major","examCombination","personalInfo","name","dateOfBirth","address","phone","cccd","ethnicity","gender","scores","transcriptScores","semester1Grade12","math","literature","english","physics","chemistry","biology","semester2Grade12","semester1Grade11","semester2Grade11","priorityCategories","documents","documents2","documents3","status","submissionDate","Date","toLocaleDateString","console","log","prev","prevStep","handleFormSubmit","error","updatedFormData","renderStep","fileName","_jsxFileName","lineNumber","columnNumber","formData","submitForm","setApplicationData","className","children","_c","$RefreshReg$"],"sources":["C:/Project_js/THweb/University4/BaiTapCuoiKi/Frontend/src/components/application/ApplicationForm.tsx"],"sourcesContent":["// src/components/application/ApplicationForm.tsx\r\n// chuyển hướng đi lên xuốngxuống\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { FormData, FormDataSetter } from \"../../types\";\r\nimport CombinedForm from \"./CombinedForm\";\r\nimport Step4_UploadDocuments from \"../../pages/Step4_UploadDocuments\";\r\nimport Step5_ReviewAndSubmit from \"../../pages/Step5_ReviewAndSubmit\";\r\nimport \"../../styles.css\";\r\n\r\ninterface ApplicationFormProps {\r\n  setPage: (page: string) => void;\r\n  currentUser?: string | null | undefined;\r\n  setFormData: FormDataSetter;\r\n  nextStep: () => void;\r\n}\r\n\r\nconst ApplicationForm: React.FC<ApplicationFormProps> = ({\r\n  setPage,\r\n  currentUser,\r\n  setFormData,\r\n  nextStep,\r\n}) => {\r\n  const [step, setStep] = useState(1);\r\n  const [formDataState, setFormDataState] = useState<FormData>({\r\n    school: \"\",\r\n    major: \"\",\r\n    examCombination: \"\",\r\n    personalInfo: {\r\n      name: currentUser || \"\",\r\n      dateOfBirth: \"\",\r\n      address: \"\",\r\n      phone: \"\",\r\n      cccd: \"\",\r\n      ethnicity: \"\",\r\n      gender: \"\",\r\n    },\r\n    scores: {},\r\n    transcriptScores: {\r\n      semester1Grade12: {\r\n        math: \"\",\r\n        literature: \"\",\r\n        english: \"\",\r\n        physics: \"\",\r\n        chemistry: \"\",\r\n        biology: \"\",\r\n      },\r\n      semester2Grade12: {\r\n        math: \"\",\r\n        literature: \"\",\r\n        english: \"\",\r\n        physics: \"\",\r\n        chemistry: \"\",\r\n        biology: \"\",\r\n      },\r\n      semester1Grade11: {\r\n        math: \"\",\r\n        literature: \"\",\r\n        english: \"\",\r\n        physics: \"\",\r\n        chemistry: \"\",\r\n        biology: \"\",\r\n      },\r\n      semester2Grade11: {\r\n        math: \"\",\r\n        literature: \"\",\r\n        english: \"\",\r\n        physics: \"\",\r\n        chemistry: \"\",\r\n        biology: \"\",\r\n      },\r\n    },\r\n    priorityCategories: [],\r\n    documents: [],\r\n    documents2: [],\r\n    documents3: [],\r\n    status: \"Chờ duyệt\",\r\n    submissionDate: new Date().toLocaleDateString(),\r\n  });\r\n\r\n  // Update parent's formData whenever local state changes\r\n  useEffect(() => {\r\n    console.log(\"Updating parent formData:\", formDataState);\r\n    setFormData(formDataState);\r\n  }, [formDataState, setFormData]);\r\n\r\n  // Update local state when currentUser changes\r\n  useEffect(() => {\r\n    if (currentUser) {\r\n      setFormDataState((prev) => ({\r\n        ...prev,\r\n        personalInfo: {\r\n          ...prev.personalInfo,\r\n          name: currentUser,\r\n        },\r\n      }));\r\n    }\r\n  }, [currentUser]);\r\n\r\n  const prevStep = () => setStep(step - 1);\r\n\r\n  const handleFormSubmit = async (): Promise<{ status: string }> => {\r\n    try {\r\n      console.log(\"Starting form submission with data:\", formDataState);\r\n\r\n      // Validate required fields\r\n      if (\r\n        !formDataState.school ||\r\n        !formDataState.major ||\r\n        !formDataState.examCombination\r\n      ) {\r\n        console.error(\"Missing required fields:\", {\r\n          school: formDataState.school,\r\n          major: formDataState.major,\r\n          examCombination: formDataState.examCombination,\r\n        });\r\n        return { status: \"error\" };\r\n      }\r\n\r\n      // Validate user\r\n      if (!currentUser) {\r\n        console.error(\"No current user found\");\r\n        return { status: \"error\" };\r\n      }\r\n\r\n      // Create updated form data\r\n      const updatedFormData = {\r\n        ...formDataState,\r\n        status: \"Chờ duyệt\",\r\n        submissionDate: new Date().toLocaleDateString(),\r\n        personalInfo: {\r\n          ...formDataState.personalInfo,\r\n          name: currentUser,\r\n        },\r\n      };\r\n\r\n      console.log(\"Prepared form data for submission:\", updatedFormData);\r\n\r\n      // Update both local and parent state\r\n      setFormDataState(updatedFormData);\r\n      setFormData(updatedFormData);\r\n\r\n      // Call nextStep to trigger the parent's submission logic\r\n      nextStep();\r\n\r\n      console.log(\"Form submitted successfully\");\r\n      return { status: \"success\" };\r\n    } catch (error) {\r\n      console.error(\"Error in form submission:\", error);\r\n      return { status: \"error\" };\r\n    }\r\n  };\r\n\r\n  const renderStep = () => {\r\n    switch (step) {\r\n      case 1:\r\n        return (\r\n          <CombinedForm\r\n            setFormData={setFormDataState}\r\n            nextStep={() => setStep(step + 1)}\r\n            setPage={setPage}\r\n            currentUser={currentUser}\r\n          />\r\n        );\r\n      case 2:\r\n        return (\r\n          <Step4_UploadDocuments\r\n            formData={formDataState}\r\n            setFormData={setFormDataState}\r\n            nextStep={() => setStep(step + 1)}\r\n            prevStep={prevStep}\r\n            setPage={setPage}\r\n            currentUser={currentUser}\r\n          />\r\n        );\r\n      case 3:\r\n        return (\r\n          <Step5_ReviewAndSubmit\r\n            formData={formDataState}\r\n            prevStep={prevStep}\r\n            submitForm={handleFormSubmit}\r\n            setPage={setPage}\r\n            currentUser={currentUser}\r\n            setApplicationData={setFormData}\r\n          />\r\n        );\r\n      default:\r\n        return null;\r\n    }\r\n  };\r\n\r\n  return <div className=\"application-form\">{renderStep()}</div>;\r\n};\r\n\r\nexport default ApplicationForm;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}